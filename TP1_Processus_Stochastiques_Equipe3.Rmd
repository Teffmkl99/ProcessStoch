---
title: "TP1 de Processus Stochastiques"
author: "Zinsou Ruffin Adja, Aziel Honore Agossou, Teffery Makonde Libanga"
date: "22/10/2020"
fontsize: 12pt
output:
  rmarkdown::pdf_document:
    fig_caption: yes        
    includes:  
      in_header: my_header.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newpage


# Question 1: Estimation des modèles de Regime-Switching à 2 et à 3 états pour la série 3

## Le modèle à 2 états

La série 3 est la série d'un indice boursier mensuel observé pendant 518 périodes (soit 43 ans et 2 mois). L'objectif de cette section est de vérifier que, tout au long de la période d'observation, les rendements passent par deux états latents ou cachés: un état dit "normal" et un autre qui est dit "de crise". L'état normal est caractérisé par une moyenne des rendements élévée, mais une variabilité réduite alors que dans l'état de crise, la moyenne des rendements est plus faible, et la variabilité est plus élevée.     

Soit $R_n^i$ le rendement pour un mois $n$ si l'état $i$ est observé. Nous faisons l'hypothèse que $R_n^i\sim N(\mu_i,\sigma^2_i)$, où $\mu_i$ et $\sigma^2_i$ sont respectivement la moyenne et la variance d'une loi normale. $i=1,2$ et $n=1,2,3,...$   

Par ailleurs, si on note 1 l'état normal, et 2 l'état de crise, alors on peut définir $P$ la matrice de transition comme suit  
$$P=
\left(\begin{array}{cc} 
P_{11} & P_{12}\\
P_{21} & P_{22}
\end{array}\right)
$$
Finalement, on peut noter $L_{i,n}(x|\theta_{n-1}=j)$ la vraisemblance de l'état $i$, à la $n^{eme}$ période et conditionnellement à l'état $j$ du processus à la période précédente $\theta_{n-1}$, du rendement $x$ lié au $i^{eme}$ état:  

$$L_{i,n}(x|\theta_{n-1}=j)=P_{ji}*\phi(\frac{x-\mu_i}{\sigma_i})$$  
où $P_{ji}$ est la probabilité de passer de l'état $j$ à l'état $i$, et $\phi(\frac{x-\mu_i}{\sigma_i})$ la densité de la loi normale de paramètres $\mu_i$ et $\sigma_i^2$. Pour simplifier, on peut noter que $r_i(x)=\phi(\frac{x-\mu_i}{\sigma_i})$  

Notre démarche consiste à calculer la vraisemblance pour chacune des 518 périodes. Ces calculs sont itératifs.    

A $t=1$, la vraisemblance de l'état $i$ est  $$L_{i,1}(x)=[Prob(État\ 1\ à\ t=0)*P_{1i}+Prob(État\ 2\ à\ t=0)*P_{2i}]*r_i(x_1)$$  
En posant, $$\pi_1=Prob(État\ 1\ à\ t=0)=\frac{P_{21}}{P_{21}+P_{12}}$$ et $$\pi_2=Prob(État\ 2\ à\ t=0)=\frac{P_{12}}{P_{21}+P_{12}}$$      
la vraisemblance de l'état $i$ à $t=1$ devient $$L_{i,1}(x)=[\pi_1*P_{1i}+\pi_2*P_{2i}]*r_i(x_1)$$ ou encore
$$L_{i,1}(x_1)=[\frac{P_{21}}{P_{21}+P_{12}}*P_{1i}+\frac{P_{12}}{P_{21}+P_{12}}*P_{2i}]*r_i(x_1)$$  
Donc la vraisemblance totale à $t=1$ peut s'écrire   $$L_{totale}(x_1)=[\frac{P_{21}}{P_{21}+P_{12}}*P_{11}+\frac{P_{12}}{P_{21}+P_{12}}*P_{21}]*r_1(x_1)+[\frac{P_{21}}{P_{21}+P_{12}}*P_{12}+\frac{P_{12}}{P_{21}+P_{12}}*P_{22}]*r_2(x_1)$$  


En procédant de même, jusqu'à la période t, on obtient que  

$$L_{1,t}(x_t)=[\frac{L_{1,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{11}+\frac{L_{2,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{21}]*r_1(x_t)$$ et 

$$L_{2,t}(x_t)=[\frac{L_{1,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{12}+\frac{L_{2,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{22}]*r_2(x_t)$$  
En posant $$P_{11}(t)=\frac{L_{1,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{11}*r_1(x_t)$$  
$$P_{21}(t)=\frac{L_{1,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{21}*r_1(x_t)$$  
$$P_{12}(t)=\frac{L_{1,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{12}*r_2(x_t)$$  
$$P_{22}(t)=\frac{L_{1,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{22}*r_2(x_t)$$   
On obtient finalement $$L_{totale}(x_t)=P_{11}(t)+P_{21}(t)+P_{12}(t)+P_{22}(t)$$  
A cette étape, nous recherchons les valeurs des paramètres $P_{12}$, $P_{21}$, $\mu_1$, $\mu_2$, $\sigma_1$ et $\sigma_2$ qui maximisent la Log-vraisemblance totale. 

\newpage

A l'aide du solveur d'Excel (voir feuille *Question1* du fichier "TP1_processus_stochastiques_Équipe3.xlsx"), on résout le problème de maximisation suivant:  
$$
\left\{
    \begin{array}{ll}
        Max \ LogVraisemblance \ totale \\
        s/c \\  
        0 \le P_{12}\le 1 \\
        0 \le P_{21}\le 1 \\
        \sigma_1>0 \\
        \sigma_2>0 \\
        \mu_1,\mu_2\in R
    \end{array}
\right.  
$$  
Les valeurs estimées des paramètres sont présentées dans le tableau ci-dessous: 

$P_{12}$    |$P_{21}$   |$\mu_1$    |$\mu_2$     |$\sigma_1$ |$\sigma_2$ | 
------------|-----------|-----------|------------|-----------|-----------|
0.045564457 |0.172071555|0.014485422|-0.013244772|0.034841846|0.068158377|

La matrice de transition est :

$$P=
\left(\begin{array}{cc} 
0.9544 & 0.0456\\
0.1721 & 0.8279
\end{array}\right)
$$  
et les probabilités limites sont :
$$\pi_1=0.7906392$$  
$$\pi_2=0.2093608$$


\newpage

## Le modèle à 3 états

Dans cette section, on estime le modèle à trois états. Pour ce modèle, la matrice de transition est:  
$$P=
\left(\begin{array}{ccc} 
P_{11} & P_{12} & P_{13}\\
P_{21} & P_{22} & P_{23}\\
P_{31} & P_{32} & P_{33}\\
\end{array}\right)
$$  
On suppose également que pour chaque état $i=1,2,3$, $R_{i,t}$ le rendement au temps $t$ suit une loi normale centrée réduite de moyenne $\mu_i$ et de variance $\sigma^2_i$. La densité de la loi normale est $$r_i(x)=\phi(\frac{x-\mu_1}{\sigma_1})$$

Enfin, la vraisemblance de l'état $i$ à $t=1$ est  
$$L_{i,1}(x)=[\pi_1*P_{1i}+\pi_2*P_{2i}+\pi_3*P_{3i}]*r_i(x_1)$$   
avec  
$$\pi_1=Prob(État\ 1\ à\ t=0)=\frac{P_{21}+P_{31}}{P_{12}+P_{13}+P_{21}+P_{23}+P_{31}+P_{32}}$$  
$$\pi_2=Prob(État\ 2\ à\ t=0)=\frac{P_{12}+P_{32}}{P_{12}+P_{13}+P_{21}+P_{23}+P_{31}+P_{32}}$$  
$$\pi_3=Prob(État\ 3\ à\ t=0)=\frac{P_{13}+P_{23}}{P_{12}+P_{13}+P_{21}+P_{23}+P_{31}+P_{32}}$$

Finalement, 
$$L_{totale}(x_1)=L_{1}(x_1)+L_{2}(x_1)+L_{3}(x_1)$$  

\newpage

En répétant ce processus jusqu'au temps $t$, on obtient :  
$$L_{totale}(x_t)=L_{1}(x_t)+L_{2}(x_t)+L_{3}(x_t) \  \ \ où$$  


$$L_{1}=\frac{L_{1}(x_{t-1})P_{11}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}+\frac{L_{2}(x_{t-1})P_{21}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}+\frac{L_{3}(x_{t-1})P_{31}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}
$$  
$$L_{2}=\frac{L_{1}(x_{t-1})P_{12}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}+\frac{L_{2}(x_{t-1})P_{22}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}+\frac{L_{3}(x_{t-1})P_{32}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}$$  
$$L_{3}=\frac{L_{1}(x_{t-1})P_{13}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}+\frac{L_{2}(x_{t-1})P_{23}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}+\frac{L_{3}(x_{t-1})P_{33}}{L_{1}(x_{t-1})+L_{2}(x_{t-1})+L_{3}(x_{t-1})}$$  

\newpage

A l'aide du solveur d'Excel, on résout le problème de maximisation suivant:  
$$
\left\{
    \begin{array}{ll}
        Max \ LogVraisemblance \ totale \\
        s/c \\  
        0 \le P_{12}\le 1 \\
        0 \le P_{13}\le 1 \\
        0 \le P_{21}\le 1 \\
        0 \le P_{23}\le 1 \\
        0 \le P_{31}\le 1 \\
        0 \le P_{32}\le 1 \\
        \sigma_1>0 \\
        \sigma_2>0 \\
        \sigma_3>0 \\
        \mu_1,\mu_2,\mu_3\in R
    \end{array}
\right.  
$$  

Les valeurs estimées des paramètres sont présentées dans le tableau ci-dessous:  

$Paramètre$    |$Valeur\ estimée$  | 
---------------|-------------------|
$P_{12}$       |0.010884011        |
$P_{13}$       |0.037651887        |
$P_{21}$       |0.03077362         |
$P_{23}$       |0.001              |
$P_{31}$       |0.253765224        |
$P_{32}$       |0.001              |
$\mu_1$        |0.01354383         |
$\mu_2$        |0.011796524        |
$\mu_3$        |-0.030100208       |
$\sigma_1$     |0.041834702        |
$\sigma_2$     |0.022652958        |
$\sigma_3$     |0.075654263        |

La matrice de transition est :  
$$P=
\left(\begin{array}{ccc} 
0.9515 & 0.0109 & 0.0377\\
0.0308 & 0.9682 & 0.0010\\
0.2538 & -0.0010 & 0.7452\\
\end{array}\right)
$$  

et les probabilités limites sont :  $\pi_1=0.8491802$, $\pi_2=0.0354667$, $\pi_3=0.115353$  
\newpage

## Choix du meilleur modèle

Le tableau ci-après présente les valeurs des critères AIC et BIC.  

$Critère$      |$Modèle \ à \ 2 \ états$  | $Modèle \ à \ 3 \ états$|
---------------|--------------------------|-------------------------|
$AIC$          |-1781.28                  |-1793.98                 |
$BIC$          |-1755.78                  |-1742.98                 |  

Les critères d'information $AIC$ et $BIC$ permettent de valider et sélectionner un modèle d'estimation statistique. On choisit alors le modèle avec le critère d'information le plus faible. En considérant cette règle, le modèle à 3 états est le meilleur modèle selon le critère $AIC$, alors que le modèle à 2 états est meilleur selon le  critère $BIC$. Mais, étant donné que le critère $BIC$ est le plus conservateur des deux, il sera retenu comme règle de sélection ultime. Par conséquent, nous retenons le modèle à 2 états comme étant le meilleur des deux modèles étudiés.

\newpage

# Question 2: Estimation d'un modèle de Regime-Switching à 2 états pour les séries 3 et 52


Ici, on fait l'hypothèse que les rendements des indices boursiers 3 et 52 sont conjointement dans le même état $i=1,2$ au temps $t$, et qu'ils suivent une loi normale bivariée.

Si $X$ est le rendement de l'indice 3 et $Y$ celui de l'indice 52, alors on peut écrire ce qui suit:
$$
\begin{pmatrix}
R_X \\
R_Y
\end{pmatrix}\sim N\left(\begin{pmatrix}
\mu_X \\
\mu_Y
\end{pmatrix},\begin{pmatrix}
\sigma^2_X & \sigma_{X,Y} \\
\sigma_{X,Y} & \sigma^2_Y
\end{pmatrix}\right)
$$  
Pour rappel, 
$$f_{X,Y}(x,y)=\frac{1}{2\pi\sqrt{det(\Sigma)}}e^{-\frac{1}{2}(x-\mu)^t\Sigma^{-1}(x-\mu)}$$  
où $\Sigma$ est la matrice de variance-covariance dont le déterminant est:    

$$det(\Sigma)=\det\begin{pmatrix} \sigma^2_X & \sigma_{X,Y} \\ \sigma_{X,Y} & \sigma_{Y}^2 \end{pmatrix}$$  
$$det(\Sigma)=\sigma_{X}^2\sigma_{Y}^2(1-\frac{(\sigma_{X,Y})^2}{\sigma_{X}^2\sigma_{Y}^2})$$  
Si on pose   
$$\rho_{X,Y}=\frac{\sigma_{X,Y}}{\sigma_{X}\sigma_{Y}}=Coefficient\ de\ corrélation\ linéaire$$  
alors, 
$$det(\Sigma)=\sigma_{X}^2\sigma_{Y}^2(1-\rho_{X,Y}^2)$$  
$$\Sigma^{-1}=\begin{pmatrix} \frac{1}{\sigma_{X}^2(1-\rho_{X,Y}^2)} & \frac{-\sigma_{X,Y}}{\sigma_{X}^2\sigma_{Y}^2(1-\rho_{X,Y}^2)}\\ \frac{-\sigma_{X,Y}}{\sigma_{X}^2\sigma_{Y}^2(1-\rho_{X,Y}^2)} & \frac{1}{\sigma_{Y}^2(1-\rho_{X,Y}^2)} \end{pmatrix}$$   
$$(X-\mu)^t\Sigma^{-1}(X-\mu)=\begin{pmatrix} x-\mu_x & y-\mu_y\end{pmatrix}\Sigma^{-1}\begin{pmatrix} x-\mu_x \\ y-\mu_y\end{pmatrix}$$  
$$(X-\mu)^t\Sigma^{-1}(X-\mu)=\frac{1}{(1-\rho_{X,Y}^2)}((\frac{x-\mu_X}{\sigma_X})^2-2\rho_{X,Y}(\frac{x-\mu_X}{\sigma_X})(\frac{y-\mu_Y}{\sigma_Y})+(\frac{y-\mu_Y}{\sigma_Y})^2)$$ 
Finalement,  
$$f_{X,Y}(x,y)=\frac{1}{2\pi\ \sigma_X \sigma_Y \sqrt{1-\rho_{X,Y}^2}}e^{-\frac{1}{2(1-\rho_{X,Y}^2)}((\frac{x-\mu_X}{\sigma_X})^2-2\rho_{X,Y}(\frac{x-\mu_X}{\sigma_X})(\frac{y-\mu_Y}{\sigma_Y})+(\frac{y-\mu_Y}{\sigma_Y})^2)}$$

La vraisemblance de l'état $i$ au temps $t=1$ peut donc s'écrire:  
$$L_{i,1}(x_1,y_1)=[\pi_1*P_{1i}+\pi_2{P_{2i}P_{12}}]*f_{X,Y}(x_1,y_1)$$ 
De même, la vraisemblance de l'état $i$ au temps $t$ est, 

$$L_{t,i}(x_t,y_t)=[\frac{L_{1,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{1i}+\frac{L_{2,t-1}(x_{t-1})}{L_{1,t-1}(x_{t-1})+L_{2,t-1}(x_{t-1})}*P_{2i}]*f_{X,Y}(x_t,y_t)$$  
Et la vraisemblance totale au temps $t$ est 
$$L_{totale}(x_t,y_t)=L_{t,1}(x_t,y_t)+L_{t,2}(x_t,y_t)$$  

\newpage

En utilisant le solveur d'Excel, nous allons rechercher les valeurs des paramètres $P_{12}$, $P_{21}$, $\mu_{1,X}$, $\mu_{1,Y}$, $\sigma_{1,X}$, $\sigma_{1,Y}$, $\rho_{1,XY}$, $\mu_{2,X}$, $\mu_{2,Y}$, $\sigma_{2,X}$, $\sigma_{2,Y}$, et $\rho_{2,XY}$ qui maximisent la somme des vraisemblances totales.  
Les valeurs estimées des paramètres sont présentées dans le tableau ci-dessous:  

$Paramètre$    |$Valeur\ estimée$  | 
---------------|-------------------|
$P_{12}$       |0.131903488        |
$P_{21}$       |0.140417410        |
$Paramètres \ État \ 1$            |
$\mu_{1,X}$    |0.015161414        |
$\mu_{1,Y}$    |0.017941471        |
$\sigma_{1,X}$ |0.028293558        |
$\sigma_{1,Y}$ |0.030316672        |
$\rho_{1,XY}$  |0.573303108        |
$Paramètres \ État \ 2$            |
$\mu_{2,X}$    |0.001939248        |
$\mu_{2,Y}$    |-0.000877651       |
$\sigma_{2,X}$ |0.057367392        |
$\sigma_{2,Y}$ |0.062508123        |
$\rho_{2,XY}$  |0.668805558        |

La matrice de transition est :  
$$P=
\left(\begin{array}{cc} 
0.8681 & 0.1319\\
0.1404 & 0.8596\\
\end{array}\right)
$$  

et les probabilités limites sont :  

$$\pi_1=0.5156$$  
$$\pi_2=0.4844$$  


## Graphiques des probabalités de se retrouver dans chacun des états  

```{r, echo=FALSE, eval=TRUE}

donnees<-data.frame(periode<-as.Date(c("1970-01-30",
"1970-02-27",
"1970-03-31",
"1970-04-30",
"1970-05-29",
"1970-06-30",
"1970-07-31",
"1970-08-31",
"1970-09-30",
"1970-10-30",
"1970-11-30",
"1970-12-31",
"1971-01-29",
"1971-02-26",
"1971-03-31",
"1971-04-30",
"1971-05-31",
"1971-06-30",
"1971-07-30",
"1971-08-31",
"1971-09-30",
"1971-10-29",
"1971-11-30",
"1971-12-31",
"1972-01-31",
"1972-02-29",
"1972-03-31",
"1972-04-28",
"1972-05-31",
"1972-06-30",
"1972-07-31",
"1972-08-31",
"1972-09-29",
"1972-10-31",
"1972-11-30",
"1972-12-29",
"1973-01-31",
"1973-02-28",
"1973-03-30",
"1973-04-30",
"1973-05-31",
"1973-06-29",
"1973-07-31",
"1973-08-31",
"1973-09-28",
"1973-10-31",
"1973-11-30",
"1973-12-31",
"1974-01-31",
"1974-02-28",
"1974-03-29",
"1974-04-30",
"1974-05-31",
"1974-06-28",
"1974-07-31",
"1974-08-30",
"1974-09-30",
"1974-10-31",
"1974-11-29",
"1974-12-31",
"1975-01-31",
"1975-02-28",
"1975-03-31",
"1975-04-30",
"1975-05-30",
"1975-06-30",
"1975-07-31",
"1975-08-29",
"1975-09-30",
"1975-10-31",
"1975-11-28",
"1975-12-31",
"1976-01-30",
"1976-02-27",
"1976-03-31",
"1976-04-30",
"1976-05-31",
"1976-06-30",
"1976-07-30",
"1976-08-31",
"1976-09-30",
"1976-10-29",
"1976-11-30",
"1976-12-31",
"1977-01-31",
"1977-02-28",
"1977-03-31",
"1977-04-29",
"1977-05-31",
"1977-06-30",
"1977-07-29",
"1977-08-31",
"1977-09-30",
"1977-10-31",
"1977-11-30",
"1977-12-30",
"1978-01-31",
"1978-02-28",
"1978-03-31",
"1978-04-28",
"1978-05-31",
"1978-06-30",
"1978-07-31",
"1978-08-31",
"1978-09-29",
"1978-10-31",
"1978-11-30",
"1978-12-29",
"1979-01-31",
"1979-02-28",
"1979-03-30",
"1979-04-30",
"1979-05-31",
"1979-06-29",
"1979-07-31",
"1979-08-31",
"1979-09-28",
"1979-10-31",
"1979-11-30",
"1979-12-31",
"1980-01-31",
"1980-02-29",
"1980-03-31",
"1980-04-30",
"1980-05-30",
"1980-06-30",
"1980-07-31",
"1980-08-29",
"1980-09-30",
"1980-10-31",
"1980-11-28",
"1980-12-31",
"1981-01-30",
"1981-02-27",
"1981-03-31",
"1981-04-30",
"1981-05-29",
"1981-06-30",
"1981-07-31",
"1981-08-31",
"1981-09-30",
"1981-10-30",
"1981-11-30",
"1981-12-31",
"1982-01-29",
"1982-02-26",
"1982-03-31",
"1982-04-30",
"1982-05-31",
"1982-06-30",
"1982-07-30",
"1982-08-31",
"1982-09-30",
"1982-10-29",
"1982-11-30",
"1982-12-31",
"1983-01-31",
"1983-02-28",
"1983-03-31",
"1983-04-29",
"1983-05-31",
"1983-06-30",
"1983-07-29",
"1983-08-31",
"1983-09-30",
"1983-10-31",
"1983-11-30",
"1983-12-30",
"1984-01-31",
"1984-02-29",
"1984-03-30",
"1984-04-30",
"1984-05-31",
"1984-06-29",
"1984-07-31",
"1984-08-31",
"1984-09-28",
"1984-10-31",
"1984-11-30",
"1984-12-31",
"1985-01-31",
"1985-02-28",
"1985-03-29",
"1985-04-30",
"1985-05-31",
"1985-06-28",
"1985-07-31",
"1985-08-30",
"1985-09-30",
"1985-10-31",
"1985-11-29",
"1985-12-31",
"1986-01-31",
"1986-02-28",
"1986-03-31",
"1986-04-30",
"1986-05-30",
"1986-06-30",
"1986-07-31",
"1986-08-29",
"1986-09-30",
"1986-10-31",
"1986-11-28",
"1986-12-31",
"1987-01-30",
"1987-02-27",
"1987-03-31",
"1987-04-30",
"1987-05-29",
"1987-06-30",
"1987-07-31",
"1987-08-31",
"1987-09-30",
"1987-10-30",
"1987-11-30",
"1987-12-31",
"1988-01-29",
"1988-02-29",
"1988-03-31",
"1988-04-29",
"1988-05-31",
"1988-06-30",
"1988-07-29",
"1988-08-31",
"1988-09-30",
"1988-10-31",
"1988-11-30",
"1988-12-30",
"1989-01-31",
"1989-02-28",
"1989-03-31",
"1989-04-28",
"1989-05-31",
"1989-06-30",
"1989-07-31",
"1989-08-31",
"1989-09-29",
"1989-10-31",
"1989-11-30",
"1989-12-29",
"1990-01-31",
"1990-02-28",
"1990-03-30",
"1990-04-30",
"1990-05-31",
"1990-06-29",
"1990-07-31",
"1990-08-31",
"1990-09-28",
"1990-10-31",
"1990-11-30",
"1990-12-31",
"1991-01-31",
"1991-02-28",
"1991-03-29",
"1991-04-30",
"1991-05-31",
"1991-06-28",
"1991-07-31",
"1991-08-30",
"1991-09-30",
"1991-10-31",
"1991-11-29",
"1991-12-31",
"1992-01-31",
"1992-02-28",
"1992-03-31",
"1992-04-30",
"1992-05-29",
"1992-06-30",
"1992-07-31",
"1992-08-31",
"1992-09-30",
"1992-10-30",
"1992-11-30",
"1992-12-31",
"1993-01-29",
"1993-02-26",
"1993-03-31",
"1993-04-30",
"1993-05-31",
"1993-06-30",
"1993-07-30",
"1993-08-31",
"1993-09-30",
"1993-10-29",
"1993-11-30",
"1993-12-31",
"1994-01-31",
"1994-02-28",
"1994-03-31",
"1994-04-29",
"1994-05-31",
"1994-06-30",
"1994-07-29",
"1994-08-31",
"1994-09-30",
"1994-10-31",
"1994-11-30",
"1994-12-30",
"1995-01-31",
"1995-02-28",
"1995-03-31",
"1995-04-28",
"1995-05-31",
"1995-06-30",
"1995-07-31",
"1995-08-31",
"1995-09-29",
"1995-10-31",
"1995-11-30",
"1995-12-29",
"1996-01-31",
"1996-02-29",
"1996-03-29",
"1996-04-30",
"1996-05-31",
"1996-06-28",
"1996-07-31",
"1996-08-30",
"1996-09-30",
"1996-10-31",
"1996-11-29",
"1996-12-31",
"1997-01-31",
"1997-02-28",
"1997-03-31",
"1997-04-30",
"1997-05-30",
"1997-06-30",
"1997-07-31",
"1997-08-29",
"1997-09-30",
"1997-10-31",
"1997-11-28",
"1997-12-31",
"1998-01-30",
"1998-02-27",
"1998-03-31",
"1998-04-30",
"1998-05-29",
"1998-06-30",
"1998-07-31",
"1998-08-31",
"1998-09-30",
"1998-10-30",
"1998-11-30",
"1998-12-31",
"1999-01-29",
"1999-02-26",
"1999-03-31",
"1999-04-30",
"1999-05-31",
"1999-06-30",
"1999-07-30",
"1999-08-31",
"1999-09-30",
"1999-10-29",
"1999-11-30",
"1999-12-31",
"2000-01-31",
"2000-02-29",
"2000-03-31",
"2000-04-28",
"2000-05-31",
"2000-06-30",
"2000-07-31",
"2000-08-31",
"2000-09-29",
"2000-10-31",
"2000-11-30",
"2000-12-29",
"2001-01-31",
"2001-02-28",
"2001-03-30",
"2001-04-30",
"2001-05-31",
"2001-06-29",
"2001-07-31",
"2001-08-31",
"2001-09-28",
"2001-10-31",
"2001-11-30",
"2001-12-31",
"2002-01-31",
"2002-02-28",
"2002-03-29",
"2002-04-30",
"2002-05-31",
"2002-06-28",
"2002-07-31",
"2002-08-30",
"2002-09-30",
"2002-10-31",
"2002-11-29",
"2002-12-31",
"2003-01-31",
"2003-02-28",
"2003-03-31",
"2003-04-30",
"2003-05-30",
"2003-06-30",
"2003-07-31",
"2003-08-29",
"2003-09-30",
"2003-10-31",
"2003-11-28",
"2003-12-31",
"2004-01-30",
"2004-02-27",
"2004-03-31",
"2004-04-30",
"2004-05-31",
"2004-06-30",
"2004-07-30",
"2004-08-31",
"2004-09-30",
"2004-10-29",
"2004-11-30",
"2004-12-31",
"2005-01-31",
"2005-02-28",
"2005-03-31",
"2005-04-29",
"2005-05-31",
"2005-06-30",
"2005-07-29",
"2005-08-31",
"2005-09-30",
"2005-10-31",
"2005-11-30",
"2005-12-30",
"2006-01-31",
"2006-02-28",
"2006-03-31",
"2006-04-28",
"2006-05-31",
"2006-06-30",
"2006-07-31",
"2006-08-31",
"2006-09-29",
"2006-10-31",
"2006-11-30",
"2006-12-29",
"2007-01-31",
"2007-02-28",
"2007-03-30",
"2007-04-30",
"2007-05-31",
"2007-06-29",
"2007-07-31",
"2007-08-31",
"2007-09-28",
"2007-10-31",
"2007-11-30",
"2007-12-31",
"2008-01-31",
"2008-02-29",
"2008-03-31",
"2008-04-30",
"2008-05-30",
"2008-06-30",
"2008-07-31",
"2008-08-29",
"2008-09-30",
"2008-10-31",
"2008-11-28",
"2008-12-31",
"2009-01-30",
"2009-02-27",
"2009-03-31",
"2009-04-30",
"2009-05-29",
"2009-06-30",
"2009-07-31",
"2009-08-31",
"2009-09-30",
"2009-10-30",
"2009-11-30",
"2009-12-31",
"2010-01-29",
"2010-02-26",
"2010-03-31",
"2010-04-30",
"2010-05-31",
"2010-06-30",
"2010-07-30",
"2010-08-31",
"2010-09-30",
"2010-10-29",
"2010-11-30",
"2010-12-31",
"2011-01-31",
"2011-02-28",
"2011-03-31",
"2011-04-29",
"2011-05-31",
"2011-06-30",
"2011-07-29",
"2011-08-31",
"2011-09-30",
"2011-10-31",
"2011-11-30",
"2011-12-30",
"2012-01-31",
"2012-02-29",
"2012-03-30",
"2012-04-30",
"2012-05-31",
"2012-06-29",
"2012-07-31",
"2012-08-31",
"2012-09-28",
"2012-10-31",
"2012-11-30",
"2012-12-31",
"2013-01-31"
)),

prob1<-c(0.055601105159938,
0.0671875969506997,
0.468729498303112,
0.00300528180729279,
0.0192008370228318,
0.0592157115107792,
0.170550118341569,
0.442747529671958,
0.72807394216862,
0.836978996317598,
0.227869836537927,
0.396047574252217,
0.676840328704415,
0.863505046195402,
0.910657979035696,
0.930198873284701,
0.750965615483002,
0.893257326953989,
0.567658046540399,
0.572812956271743,
0.727223228331657,
0.587345394840947,
0.816486898522955,
0.630848256266899,
0.774451957469554,
0.83940938788388,
0.92214643611813,
0.937641465558781,
0.922579233384989,
0.876737572215511,
0.843158812649875,
0.901818387550584,
0.826127696410019,
0.911022834128224,
0.897372038884086,
0.934841692014185,
0.878249647452879,
0.0354184722529745,
0.352748372107237,
0.144517268174831,
0.415569826987622,
0.728953662342259,
0.714236088767243,
0.470564686463654,
0.60501224258288,
0.828397405077608,
0.000014936100922797,
0.0694162402560102,
0.349518562823106,
0.636676175530167,
0.656592063591086,
0.527012787255127,
0.369300666807319,
0.297645527586044,
0.0198902931813737,
0.000158720539345431,
0.0000491021697703995,
4.39239910795102E-07,
0.0549484812458141,
0.303068326987626,
0.000304959670887626,
0.0211475028991793,
0.231473403373387,
0.558282239382625,
0.54315487653186,
0.1305567603707,
0.0320838564902789,
0.274166451988168,
0.184419982988042,
0.283430605374262,
0.665067275187432,
0.818613674283239,
0.133779057056457,
0.457667203850484,
0.44236536628929,
0.696777863782586,
0.750829472334264,
0.82339408002531,
0.872441060104189,
0.915586597972937,
0.842826742640103,
0.370966908411505,
0.670756558503623,
0.224311573630489,
0.170139699459799,
0.381580535709559,
0.662519924822947,
0.85205758851463,
0.870849808939608,
0.885086582967278,
0.885888938509683,
0.807108055370534,
0.894096346972625,
0.648143000924207,
0.780216470616624,
0.873804659628021,
0.35732086462694,
0.548533530324061,
0.622431530397414,
0.0278468174794481,
0.407342722486457,
0.461251490227627,
0.435992073673708,
0.760191426378337,
0.854426636638947,
0.000827023946730505,
0.000528155928617448,
0.319601360867921,
0.49315742637151,
0.520965315021289,
0.654590030631274,
0.834308819523794,
0.837950836447499,
0.901623276354053,
0.933967058515355,
0.917510697575637,
0.881827344631235,
0.0603037403646201,
0.378017620190951,
0.716570422626633,
0.770484622791441,
0.867228929487623,
0.0005272328759084,
0.114741360683712,
0.42076098973722,
0.618697927631784,
0.336144595933031,
0.67361755563948,
0.869395728555009,
0.928315662298661,
0.0132250982367866,
0.155929891225035,
0.24074195990183,
0.436709908352471,
0.746166795763653,
0.786426003835769,
0.702016463708365,
0.860798951764044,
0.594374556527524,
0.1095704778953,
0.000791918107494517,
0.215452005988078,
0.0658719703444543,
0.257764161307994,
0.512988944674825,
0.0905022898110134,
0.0906103135786972,
0.375746825170278,
0.443222339550535,
0.0251118718794763,
0.285707216028772,
0.00197613715136174,
0.302320913350712,
0.00772407889677451,
0.203466200880977,
0.214035993485938,
0.351204893219298,
0.722504763331289,
0.87431435220628,
0.739114881272457,
0.832849559095196,
0.899900862811675,
0.817964416143559,
0.829811377092875,
0.909454445762264,
0.909236710507086,
0.941018008694969,
0.905960743863331,
0.870966629382396,
0.675819116314806,
0.517269080628088,
0.666299352643155,
0.00982126501155926,
0.311714795501118,
0.08385690042946,
0.0273652569170151,
0.33931280785783,
0.699340687733311,
0.839138695940815,
0.920156463564985,
0.660816568548218,
0.803150834951997,
0.598570331609375,
0.803235458992518,
0.815692703909648,
0.916915844957824,
0.848361608033653,
0.874719851022319,
0.452520678892091,
0.639837962378579,
0.649426429257359,
0.79371763850869,
0.905135429338587,
0.529062992413822,
0.0310730365994269,
0.070298151319048,
0.0119802704536188,
0.200222110890683,
0.00558560845170419,
0.0682496324148757,
0.00281381164402373,
0.000355939592693038,
0.288249164442493,
0.155195361749544,
0.00492632297979093,
0.368776080088499,
0.358401505775328,
0.0211393023065871,
0.375342813387769,
0.0847365764277536,
0.237399169528136,
0.424336023421273,
0.578455633027975,
1.10695478279627E-13,
0.000929337066541595,
0.136928642465083,
0.434884018189757,
0.617504864336799,
0.113381032690768,
0.52612202889784,
0.498449904220284,
0.24996395246041,
0.562176375296186,
0.149784643566632,
0.498783712785585,
0.459298498176322,
0.30692259518483,
0.667746738132508,
0.440054233913431,
0.525327637780255,
0.588941033980252,
0.61575637420124,
0.0520643650501054,
0.325542208003408,
0.0412816119917958,
0.0691579669826274,
0.311380505430964,
0.311458480541536,
0.627711408078916,
0.847038133201687,
0.272985212785554,
0.0178768318835222,
0.0000341072653349217,
0.234571105405973,
0.0521921585611352,
0.364715146608793,
0.697349862319385,
0.00245318852109077,
4.20664657372877E-06,
0.0000472406909819553,
0.000357765116023805,
0.371168051734452,
0.644166669315126,
0.319713297092622,
0.0322461575137993,
0.41635221393913,
0.640802157420771,
0.0997890035369734,
0.418808488133674,
0.494259441011934,
0.362864967972552,
0.727096877883164,
0.431200980977501,
0.0466861266621523,
0.264298187881671,
0.266746464682173,
0.0614541688455598,
0.376577218450822,
0.410087078047191,
0.308398029395974,
0.188677057540838,
0.0838068766885214,
0.274704113824425,
0.131972346231571,
0.446000566693678,
0.757938573005561,
0.877999704503803,
0.929128578470046,
0.723320957963049,
0.0371504843802647,
0.435550560883194,
0.64955033819712,
0.806321819886829,
0.883427397129508,
0.855961356928041,
0.924443346371984,
0.0492930536216339,
0.169160531519115,
0.246107115479797,
0.410272250746685,
0.227033147459778,
0.587010808938405,
0.776135042906747,
0.756759560894787,
0.862483305402271,
0.91089302515878,
0.825056194360121,
0.917644074424782,
0.624215569392127,
0.83983136808882,
0.449380805003595,
0.581495336718543,
0.730612437009359,
0.881100667958085,
0.789253052061304,
0.774792372724086,
0.845747642543212,
0.718233591820353,
0.822305707930087,
0.804153108506994,
0.881706671562747,
0.923500225277725,
0.909182408979042,
0.932802835608067,
0.946529942034094,
0.949249893630581,
0.856859666644049,
0.91896339199903,
0.69807069072974,
0.849868713590699,
0.84937427151278,
0.865192647257016,
0.740346478975093,
0.797874815808578,
0.0644427364597603,
0.468297094747707,
0.332518829955972,
0.241178036308742,
0.429292174259324,
0.677251586364123,
0.377187812845522,
0.0274745546421193,
0.290640674084868,
0.0305874411223858,
0.104007633052011,
0.506714305173521,
0.756774007056838,
0.715838798867871,
0.817707672066565,
0.910943279239986,
0.891411080168861,
0.866417385051418,
0.904712021097016,
2.82423528596164E-06,
0.00718939726852837,
0.0454660567564768,
0.220276783959188,
0.44373246770505,
0.548777299358818,
0.570662668118754,
0.793694903239004,
0.893336788164327,
0.602983668169345,
0.757159368496493,
0.570709644707612,
0.790160534626784,
0.749486245239698,
0.755587433366184,
0.893792576577201,
0.679652957046055,
0.159301699982467,
0.271205620949383,
0.0747009176251845,
0.0753073533168509,
0.226494017310117,
0.597501943006615,
0.528076468478513,
0.626520383473603,
0.192211088265095,
0.356826698565611,
0.0229360656948101,
0.317020047070254,
0.536413057829465,
0.00485522692393663,
0.00772524493144859,
0.117968962166447,
0.217795611486898,
0.231020712117431,
0.470497604605087,
0.100895302375477,
0.000543723368342275,
0.394901017656319,
0.363390715213222,
0.70938151127373,
0.424531407328914,
0.626716638887377,
0.802963642987123,
0.166024032999313,
0.509301932849939,
0.0462030733759573,
0.000585737008782694,
0.342286818674238,
0.0000543509110342444,
0.0606416798165352,
0.29344150143995,
0.0933175714459399,
0.168862878733348,
0.383946228197994,
0.564478921626505,
0.282528485305747,
0.496206302486357,
0.797504683923379,
0.912211850114781,
0.942772439905595,
0.90180852683103,
0.872528155424302,
0.930162644792361,
0.853459248438726,
0.924733319979464,
0.944942456240814,
0.918898798893377,
0.860148225988935,
0.920563950381043,
0.945032435327136,
0.79378312820331,
0.898654872851378,
0.934789275250144,
0.942320294943248,
0.901234919462108,
0.929112331484986,
0.862212985382831,
0.914090291815617,
0.868141374533755,
0.830065916186268,
0.870595276202028,
0.924920915988583,
0.936409584991339,
0.912083214142582,
0.911002972216014,
0.817597209115503,
0.895118794412417,
0.878138608288874,
0.876227481878751,
0.913885136300179,
0.938149264722289,
0.923052678199324,
0.759194829846059,
0.87689066480247,
0.926827191241311,
0.945531488720193,
0.924382751885012,
0.937837620752915,
0.948161699777425,
0.948819126081439,
0.944006998509254,
0.910850104085989,
0.939770271093144,
0.931823160911408,
0.93822872373164,
0.914352686634546,
0.83700550094514,
0.852752860236163,
0.890230367817624,
0.921246991035949,
0.659030609298189,
0.762042749500461,
0.0220708384945173,
0.146854693843827,
0.430559268197638,
0.652833356213103,
0.864007321775102,
0.0282870344789622,
0.155378492449441,
0.148424667651399,
1.61426260298952E-06,
2.14524278031283E-14,
0.00696447192740168,
0.274637668477853,
0.00152710527108118,
0.0000570368899059249,
0.0831215401757503,
0.0108314385589307,
0.0112138743237287,
0.31070179160886,
0.207241928027821,
0.5608599314215,
0.79684661794563,
0.818781146693732,
0.803777713843904,
0.910691963831131,
0.626025196043147,
0.760971144364292,
0.779273975125441,
0.822076608309286,
0.00200724000980391,
0.0532668615864875,
0.10626537098559,
0.127244646857572,
0.0698395404774633,
0.436532513994017,
0.322332334586031,
0.34927748453065,
0.718265080380007,
0.874745010111338,
0.867572475265824,
0.899960545514437,
0.838935619216642,
0.853467185733101,
0.84709947159217,
0.0570607957835462,
0.000574501466473884,
0.0148294399124691,
0.0765821728042103,
0.371196607262995,
0.630684902475857,
0.790590102948314,
0.80485912101779,
0.850247695594979,
0.00257378020180683,
0.24766007536417,
0.645649705245689,
0.860964240790319,
0.927595613533239,
0.90537660056998,
0.937182671235877,
0.943172369338937,
0.915993667005782
),

prob2<-c(0.944398894840062,
0.9328124030493,
0.531270501696888,
0.996994718192707,
0.980799162977168,
0.940784288489221,
0.829449881658431,
0.557252470328042,
0.27192605783138,
0.163021003682402,
0.772130163462073,
0.603952425747783,
0.323159671295585,
0.136494953804598,
0.0893420209643041,
0.0698011267152993,
0.249034384516997,
0.106742673046011,
0.432341953459601,
0.427187043728257,
0.272776771668343,
0.412654605159053,
0.183513101477045,
0.369151743733101,
0.225548042530446,
0.16059061211612,
0.0778535638818696,
0.0623585344412191,
0.0774207666150113,
0.123262427784489,
0.156841187350125,
0.0981816124494164,
0.173872303589981,
0.0889771658717762,
0.102627961115914,
0.0651583079858154,
0.121750352547121,
0.964581527747025,
0.647251627892764,
0.855482731825169,
0.584430173012378,
0.271046337657741,
0.285763911232757,
0.529435313536346,
0.39498775741712,
0.171602594922392,
0.999985063899077,
0.93058375974399,
0.650481437176894,
0.363323824469833,
0.343407936408914,
0.472987212744873,
0.630699333192681,
0.702354472413956,
0.980109706818626,
0.999841279460655,
0.99995089783023,
0.999999560760089,
0.945051518754186,
0.696931673012374,
0.999695040329112,
0.978852497100821,
0.768526596626613,
0.441717760617375,
0.45684512346814,
0.869443239629299,
0.967916143509721,
0.725833548011832,
0.815580017011958,
0.716569394625738,
0.334932724812568,
0.181386325716761,
0.866220942943543,
0.542332796149516,
0.55763463371071,
0.303222136217414,
0.249170527665736,
0.17660591997469,
0.127558939895811,
0.0844134020270631,
0.157173257359897,
0.629033091588495,
0.329243441496377,
0.775688426369512,
0.829860300540201,
0.618419464290441,
0.337480075177053,
0.14794241148537,
0.129150191060392,
0.114913417032722,
0.114111061490317,
0.192891944629466,
0.105903653027375,
0.351856999075793,
0.219783529383376,
0.126195340371979,
0.64267913537306,
0.451466469675939,
0.377568469602586,
0.972153182520552,
0.592657277513543,
0.538748509772373,
0.564007926326292,
0.239808573621663,
0.145573363361053,
0.99917297605327,
0.999471844071383,
0.680398639132079,
0.50684257362849,
0.479034684978711,
0.345409969368726,
0.165691180476206,
0.162049163552501,
0.0983767236459467,
0.066032941484645,
0.0824893024243631,
0.118172655368765,
0.93969625963538,
0.621982379809049,
0.283429577373367,
0.229515377208559,
0.132771070512377,
0.999472767124091,
0.885258639316288,
0.57923901026278,
0.381302072368216,
0.663855404066969,
0.32638244436052,
0.130604271444991,
0.0716843377013386,
0.986774901763213,
0.844070108774965,
0.75925804009817,
0.563290091647529,
0.253833204236347,
0.213573996164231,
0.297983536291635,
0.139201048235956,
0.405625443472476,
0.8904295221047,
0.999208081892505,
0.784547994011922,
0.934128029655546,
0.742235838692006,
0.487011055325175,
0.909497710188987,
0.909389686421303,
0.624253174829722,
0.556777660449465,
0.974888128120524,
0.714292783971228,
0.998023862848638,
0.697679086649288,
0.992275921103225,
0.796533799119023,
0.785964006514062,
0.648795106780702,
0.277495236668711,
0.12568564779372,
0.260885118727543,
0.167150440904804,
0.100099137188325,
0.182035583856441,
0.170188622907124,
0.0905455542377359,
0.0907632894929144,
0.0589819913050314,
0.094039256136669,
0.129033370617604,
0.324180883685194,
0.482730919371912,
0.333700647356845,
0.990178734988441,
0.688285204498882,
0.91614309957054,
0.972634743082985,
0.66068719214217,
0.300659312266689,
0.160861304059185,
0.0798435364350145,
0.339183431451782,
0.196849165048003,
0.401429668390625,
0.196764541007482,
0.184307296090352,
0.0830841550421758,
0.151638391966347,
0.125280148977682,
0.547479321107909,
0.360162037621421,
0.350573570742641,
0.20628236149131,
0.0948645706614134,
0.470937007586178,
0.968926963400573,
0.929701848680952,
0.988019729546381,
0.799777889109317,
0.994414391548296,
0.931750367585124,
0.997186188355976,
0.999644060407307,
0.711750835557507,
0.844804638250456,
0.995073677020209,
0.631223919911501,
0.641598494224672,
0.978860697693413,
0.624657186612231,
0.915263423572246,
0.762600830471864,
0.575663976578727,
0.421544366972025,
0.999999999999889,
0.999070662933458,
0.863071357534917,
0.565115981810243,
0.382495135663201,
0.886618967309232,
0.47387797110216,
0.501550095779716,
0.75003604753959,
0.437823624703814,
0.850215356433369,
0.501216287214415,
0.540701501823678,
0.69307740481517,
0.332253261867492,
0.559945766086569,
0.474672362219745,
0.411058966019748,
0.38424362579876,
0.947935634949895,
0.674457791996592,
0.958718388008204,
0.930842033017373,
0.688619494569036,
0.688541519458464,
0.372288591921084,
0.152961866798313,
0.727014787214446,
0.982123168116478,
0.999965892734665,
0.765428894594027,
0.947807841438865,
0.635284853391207,
0.302650137680615,
0.997546811478909,
0.999995793353426,
0.999952759309018,
0.999642234883976,
0.628831948265548,
0.355833330684874,
0.680286702907378,
0.967753842486201,
0.58364778606087,
0.359197842579229,
0.900210996463027,
0.581191511866326,
0.505740558988066,
0.637135032027448,
0.272903122116836,
0.568799019022499,
0.953313873337848,
0.735701812118329,
0.733253535317827,
0.93854583115444,
0.623422781549178,
0.589912921952809,
0.691601970604025,
0.811322942459162,
0.916193123311479,
0.725295886175575,
0.868027653768429,
0.553999433306322,
0.242061426994438,
0.122000295496197,
0.0708714215299541,
0.276679042036951,
0.962849515619735,
0.564449439116805,
0.35044966180288,
0.193678180113171,
0.116572602870492,
0.144038643071959,
0.0755566536280157,
0.950706946378366,
0.830839468480885,
0.753892884520203,
0.589727749253315,
0.772966852540222,
0.412989191061595,
0.223864957093253,
0.243240439105213,
0.137516694597729,
0.0891069748412202,
0.174943805639879,
0.0823559255752176,
0.375784430607873,
0.16016863191118,
0.550619194996405,
0.418504663281457,
0.269387562990641,
0.118899332041915,
0.210746947938696,
0.225207627275914,
0.154252357456788,
0.281766408179647,
0.177694292069913,
0.195846891493006,
0.118293328437253,
0.0764997747222748,
0.0908175910209584,
0.0671971643919328,
0.0534700579659059,
0.0507501063694189,
0.143140333355951,
0.0810366080009701,
0.30192930927026,
0.150131286409301,
0.15062572848722,
0.134807352742984,
0.259653521024907,
0.202125184191422,
0.93555726354024,
0.531702905252293,
0.667481170044028,
0.758821963691258,
0.570707825740676,
0.322748413635877,
0.622812187154478,
0.972525445357881,
0.709359325915132,
0.969412558877614,
0.895992366947989,
0.493285694826479,
0.243225992943163,
0.284161201132129,
0.182292327933435,
0.0890567207600142,
0.108588919831139,
0.133582614948582,
0.0952879789029841,
0.999997175764714,
0.992810602731472,
0.954533943243523,
0.779723216040812,
0.55626753229495,
0.451222700641182,
0.429337331881246,
0.206305096760996,
0.106663211835673,
0.397016331830655,
0.242840631503507,
0.429290355292388,
0.209839465373216,
0.250513754760302,
0.244412566633816,
0.106207423422799,
0.320347042953945,
0.840698300017533,
0.728794379050617,
0.925299082374816,
0.924692646683149,
0.773505982689883,
0.402498056993385,
0.471923531521487,
0.373479616526397,
0.807788911734905,
0.643173301434388,
0.97706393430519,
0.682979952929746,
0.463586942170535,
0.995144773076063,
0.992274755068551,
0.882031037833554,
0.782204388513102,
0.768979287882569,
0.529502395394914,
0.899104697624523,
0.999456276631658,
0.605098982343681,
0.636609284786778,
0.29061848872627,
0.575468592671086,
0.373283361112623,
0.197036357012877,
0.833975967000687,
0.490698067150061,
0.953796926624043,
0.999414262991217,
0.657713181325762,
0.999945649088966,
0.939358320183465,
0.70655849856005,
0.90668242855406,
0.831137121266652,
0.616053771802006,
0.435521078373495,
0.717471514694253,
0.503793697513643,
0.202495316076621,
0.0877881498852194,
0.0572275600944049,
0.0981914731689696,
0.127471844575698,
0.0698373552076393,
0.146540751561274,
0.0752666800205361,
0.0550575437591856,
0.0811012011066228,
0.139851774011065,
0.0794360496189574,
0.054967564672864,
0.20621687179669,
0.101345127148622,
0.0652107247498563,
0.0576797050567525,
0.0987650805378919,
0.0708876685150138,
0.137787014617169,
0.0859097081843827,
0.131858625466245,
0.169934083813732,
0.129404723797971,
0.0750790840114171,
0.0635904150086613,
0.0879167858574183,
0.0889970277839861,
0.182402790884497,
0.104881205587583,
0.121861391711126,
0.123772518121249,
0.086114863699821,
0.0618507352777114,
0.0769473218006764,
0.240805170153941,
0.12310933519753,
0.0731728087586893,
0.0544685112798071,
0.075617248114988,
0.0621623792470848,
0.0518383002225746,
0.0511808739185604,
0.055993001490746,
0.0891498959140106,
0.0602297289068559,
0.068176839088592,
0.0617712762683599,
0.0856473133654541,
0.16299449905486,
0.147247139763837,
0.109769632182376,
0.0787530089640506,
0.340969390701812,
0.237957250499539,
0.977929161505483,
0.853145306156173,
0.569440731802362,
0.347166643786897,
0.135992678224898,
0.971712965521038,
0.844621507550559,
0.851575332348601,
0.999998385737397,
0.999999999999978,
0.993035528072598,
0.725362331522147,
0.998472894728919,
0.999942963110094,
0.91687845982425,
0.989168561441069,
0.988786125676271,
0.68929820839114,
0.792758071972179,
0.4391400685785,
0.20315338205437,
0.181218853306268,
0.196222286156096,
0.089308036168869,
0.373974803956853,
0.239028855635708,
0.220726024874559,
0.177923391690714,
0.997992759990196,
0.946733138413512,
0.89373462901441,
0.872755353142428,
0.930160459522537,
0.563467486005983,
0.677667665413969,
0.65072251546935,
0.281734919619993,
0.125254989888662,
0.132427524734176,
0.100039454485563,
0.161064380783358,
0.146532814266899,
0.15290052840783,
0.942939204216454,
0.999425498533526,
0.985170560087531,
0.92341782719579,
0.628803392737005,
0.369315097524143,
0.209409897051686,
0.19514087898221,
0.149752304405021,
0.997426219798193,
0.75233992463583,
0.354350294754311,
0.139035759209681,
0.0724043864667606,
0.09462339943002,
0.0628173287641234,
0.0568276306610628,
0.0840063329942175
))

plot(donnees$periode,donnees$prob1, pch=16, lwd=2, type="l",col="green",ylab="Probabilité",xlab="Période(mois)", main="Probablité État normal")

plot(donnees$periode,donnees$prob2,pch=16,lwd=2, type="l",col="red",ylab="Probabilité",xlab="Période(mois)", main="Probablité État de crise")

```





## Description de l'évolution des marchés depuis 1970  

Les rendements moyens de l'état 1 sont supérieurs à ceux de l'état 2. En outre, la volatilité du rendement est plus faible dans l'état 1 que dans l'état 2, et cela quel que soit l'indice considéré. Ces résultats confirment que l'état 1 est bien l'état normal ou de croissance, alors que l'état 2 est bien l'état de crise pour les deux indices étudiés (3 et 52).

Sur l'ensemble de la période, l'état normal a été observé avec une plus grande fréquence que l'état de crise (54% pour le premier contre 46% pour le second). En début de période, les marchés sont en crise. Cette crise dure 8 mois (de janvier 1970 à août 1970). On note également que les épisodes de crise sont moins longues que ceux de croissance. Ainsi, la crise la plus longue a duré 18 mois (de mars 1986 à août 1987), alors qu'on observe plusieurs périodes de croissance de 23, 25, voire 55 mois (respectivement, de janvier 1971 à janvier 1973, de février 1995 à décembre 1996, et de juin 2003 à décembre 2012). La période d'analyse s'achève alors que les marchés sont dans un état de croissance qui a débuté à fin juillet 2012 et qui se poursuivait encore jusqu'à fin janvier 2013.

## Paramètres de modélisation de la dépendance entre les deux indices boursiers  

Les paramètres permettant de modéliser la dépendance des deux indices boursiers sont les coefficients de corrélation linéaire calculés pour chaque état:
$\rho_{1,XY}=0.573303108$, et $\rho_{2,XY}=0.668805558$. Les valeurs de ces coefficients indiquent que les deux indices sont positivement correlés. Ce qui signifie qu'ils évoluent dans le même sens. On note toutefois que la dépendance positive entre les indices est plus forte en situation de crise (État 2) que dans l'état normal.

\newpage

## Test de l'égalité des coefficients de corrélation linéaires $\rho_{1,XY}$ et  $\rho_{2,XY}$

Le test de l'égalité des coefficients de corrélation linéaire a conduit à l'estimation de deux modèles à changement de régime (modèle 2 états) ayant chacun pour contrainte $H_0$ ou $H_1$.

$$H_0:\rho_{1,XY}=\rho_{2,XY}$$  
$$H_1:\rho_{1,XY}\neq\rho_{2,XY}$$

$Critères$        |$H_0$              | $H_1$
------------------|-------------------|-------
$LogVraisemblance$| 1884,49           | 1885.07  
$AIC$             |-3756.98           |-3758.14
$BIC$             |-3731.48           |-3732.64

Sous l'hypothèse ou la contrainte $H_1$, logVraisemblance est maximale, et les critères d'information (AIC et BIC) sont à valeurs minimales. Cela conduit à retenir l'hypothèse $H_1$. On conclut qu'il ne serait pas juste de postuler comme simplification que $H_0:\rho_{1,XY}=\rho_{2,XY}$.  

\newpage

# Question 3: Simulation des rendements mensuels des deux indices boursiers sur 20 ans  

## Procédure pour simuler les états suivant une chaîne de Markov

Si on définit la chaîne de Markov:  
$$X=(X_n,n=1,2,3,...)$$  
sur l'espace d'états $\{1,2\}$ où:  
$$État1:\ "État \ normal"$$

$$État2:\ "État \ de \ crise"$$  
Dont la matrice de transition est :  
$$P=
\left(\begin{array}{cc} 
P_{11} & P_{12}\\
P_{21} & P_{22}
\end{array}\right)
$$

et avec pour distribution stationnaire:  $\pi_1$ et $\pi_2$,  
On peut simuler une chaîne de Markov, en suivant l'algorithme à deux étapes suivant:  

* Étape 1: Détermination de l'état initial  
  
  

 \ \  \ \ \ \ \  \ \ \ \ \  \ \ \ \ \  \ \ \ \ \  \ \ \ \ \ \ \ \ On tire $U\sim \ Uniforme[0,1]$.    

$$
On \ décide \ que \left\{
    \begin{array}{ll}
        \ X_{1}=1 & \mbox{si }  \ U\ <\pi_1, \\
        X_{1}=2 & \mbox{sinon.}
    \end{array}
\right.
$$  

* Étape 2: Détermination des états suivants (état2 à état240) 
  
  

\ \  \ \ \ \ \  \ \ \ \ \  \ \ \ \ \  \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ On tire à nouveau $U\sim \ Uniforme[0,1]$

$$
Si \ X_n=1 \ alors \left\{
    \begin{array}{ll}
        \ X_{n+1}=1 & \mbox{si }  \ U\ <P_{11}, \\
        X_{n+1}=2 & \mbox{sinon.}
    \end{array}
\right.
$$  
$$
Si \ X_n=2 \ alors \left\{
    \begin{array}{ll}
        \ X_{n+1}=2 & \mbox{si }  \ U\ <P_{22}, \\
        X_{n+1}=1 & \mbox{sinon.}
    \end{array}
\right.
$$

## Procédure pour simuler les rendements suivant une loi normale bivariée  

* Simuler $X\sim N(0,1)$ par la méthode de la fonction de répartition inverse, cest-à-dire appliquer la fonction de répartiion inverse de la loi normale standard à des réalisations d'une loi $Uniforme(0,1)$.    
* Poser $Y=\rho_{XY} X + \sqrt{(1-\rho_{XY}^2)}Z$ où $Z\sim N(0,1)$ où $\rho_{XY}$ dépend des états simulés antérieurement.    
* Poser $X'=\sigma_XX+\mu_X$ et $Y'=\sigma_YY+\mu_Y$.  


## Histogrammes des rendements mensuels et annuels : simulés vs. historiques

Les états et les rendements simulées sont présentés dans les feuilles *Question3_Simulation_Scenarios*, *SimulationsR1*, *SimulationsR2* et *Simul. rendement Annuel*, et *Rendements historiques*. Ces données ont permis de faire les graphiques ci-après.  


```{r pressure, echo=FALSE, fig.cap="Comparaison des rendements mensuels de l'indice 1", out.width = '100%'}
knitr::include_graphics("Image1.jpg")
```
 
\newpage
  
```{r, echo=FALSE, fig.cap="Comparaison des rendements mensuels de l'indice 2", out.width = '100%'}
knitr::include_graphics("Image2.jpg")
```
  
\newpage

```{r, echo=FALSE, fig.cap="Comparaison des rendements annuels de l'indice 1", out.width = '100%'}
knitr::include_graphics("Image3.jpg")
```
 

\newpage 
  
```{r, echo=FALSE, fig.cap="Comparaison des rendements annuels de l'indice 2", out.width = '100%'}
knitr::include_graphics("Image4.jpg")
```
  


## Efficacité du modèle  

Le modèle réplique bien les distributions mensuelles du rendement des deux indices, car les courbes des rendements simulés s'ajustent presque parfaitement aux histogrammes des rendements historiques.

En ce qui concerne les rendements annuels, les ajustements ne sont pas de bonne qualité, car les courbes des rendements simulés ne répliquent pas les ailes de la distribution (queues droite et gauche de la distribution). Il en est de même, de l'aplatissement (le kurtosis), l'asymétrie (le coefficient d'asymétrie), et des caractéristiques de tendance centrale (la moyenne et la médiane). Toutes ces statistiques ne sont pas bien répliquées par le modèle.

Pour que le modèle réplique correctement les statistiques citées ci-dessus, on pourrait modifer les écarts-types des rendements par état, car ils déterminent la valeur de la plupart de ces statistiques. 


\newpage


# Question 4 : Efficacité du rebalancement  

Afin de tester l'efficacité du rebalancement (50/50), nous avons fait l'hypothèse que le détenteur du portefeuille investit $500\ 000\$$ dans chaque actif au début de l'opération. Par la suite, les rebalancements sont effectués pour garder des proportions de 50% pour chaque classe d'actif.

Le tableau ci- après indique les rendements réalisés (calculs détaillés dans la feuille *Question 4Rebalancement*).   

```{r, echo=FALSE, fig.cap="Tableau des rendement du portefeuille avec différentes périodes de rebalancement", out.width = '100%'}
knitr::include_graphics("Image5.jpg")

```
  
  
Selon le tableau 5, on peut conclure que la meilleure option est de n’effectuer aucun rebalancement. En effet, lorsque le détenteur du portefeuille décide de procéder au rebalancement de son portefeuille, de façon mensuelle ou annuelle, il en tire un rendement moyen annuel qui est inférieur au rendement moyen annuel quand il ne rebalance pas son portefeuille. Cette dernière stratégie lui assure un rendement moyen annuel d'au moins $10,67\%$. Le rebalancement n'a donc aucune valeur ajoutée dans ce contexte. Si le rebalancement avait un coût, le rendement moyen annuel généré par cette stratégie aurait été encore plus faible. 

\newpage

# Bibliographie  

* Hamilton, D.J.(1989), A new approach to the economic analysis of nonstationary time series and the business cycle. Econometrica, Volume 57, No.2, pp357-384.

* Hardy, M. (2001), A Regime-Switching Model of Long-Term Stock Returns. North American Actuarial Journal, Volume 5, Issue 2